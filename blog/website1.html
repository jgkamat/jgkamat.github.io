<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Creating A Blog in Org Mode</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="Jay Kamat" />
<link rel="stylesheet" href="https://jgkamat.github.io/src/jgkamat.css"/>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2018 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<h1 class="title">Creating A Blog in Org Mode</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#h:ua1fi9s0gyh0">1. Overview</a></li>
<li><a href="#h:vw6fi9s0gyh0">2. Org Projects</a>
<ul>
<li><a href="#h:n3bfi9s0gyh0">2.1. Basic Setup</a></li>
<li><a href="#h:ifffi9s0gyh0">2.2. Customization</a></li>
<li><a href="#h:edjfi9s0gyh0">2.3. Making this Shareable</a></li>
</ul>
</li>
<li><a href="#h:7bnfi9s0gyh0">3. Custom CSS on HTML Exports</a></li>
<li><a href="#h:qyqfi9s0gyh0">4. Dynamic Org Exports</a></li>
<li><a href="#h:pmufi9s0gyh0">5. Side Note: Divs</a></li>
<li><a href="#h:u4yfi9s0gyh0">6. Wrapping Up</a></li>
<li><a href="#h:722gi9s0gyh0">7. Navigation</a></li>
</ul>
</div>
</div>

<div id="outline-container-org6a3b1d7" class="outline-2">
<h2 id="h:ua1fi9s0gyh0"><a id="org6a3b1d7"></a><span class="section-number-2">1</span> Overview</h2>
<div class="outline-text-2" id="text-h:ua1fi9s0gyh0">
<p>
<b>NOTE:</b> My website used to be build with ox-twbs, now it's built on ox-html.
Commit <a href="https://github.com/jgkamat/jgkamat.github.io/tree/bb5eadb640f982a0acdc6713dd99bfce64328798">bb5eadb6</a> is one of the last to use ox-twbs.
</p>

<p>
Org is a very powerful tool, but most of the org setups I've seen hasn't used it
to its full potential. This website is one example of a complex, multi-page
project built in org. This post is a 'brief' overview of how it was created.
</p>

<p>
This blog was created with:
</p>

<ul class="org-ul">
<li><a href="https://www.gnu.org/software/emacs/">Emacs</a></li>
<li><a href="http://orgmode.org/">org-mode</a></li>
<li><a href="https://github.com/marsmining/ox-twbs">ox-twbs</a></li>
</ul>

<p>
Features:
</p>
<ul class="org-ul">
<li>Homepage</li>
<li>Blogging Engine
<ul class="org-ul">
<li>Prev/Next Links</li>
<li>Archive Page (sorted)</li>
<li>Automatically add new org files to blog/archive</li>
</ul></li>
</ul>

<p>
This post will go over everything you need to set up a complex, customized, and
dynamic org project like this one. It assumes you are familiar with org, and
that you know elisp.
</p>
</div>
</div>

<div id="outline-container-org6c45183" class="outline-2">
<h2 id="h:vw6fi9s0gyh0"><a id="org6c45183"></a><span class="section-number-2">2</span> Org Projects</h2>
<div class="outline-text-2" id="text-h:vw6fi9s0gyh0">
</div>
<div id="outline-container-orgb2ed39d" class="outline-3">
<h3 id="h:n3bfi9s0gyh0"><a id="orgb2ed39d"></a><span class="section-number-3">2.1</span> Basic Setup</h3>
<div class="outline-text-3" id="text-h:n3bfi9s0gyh0">
<p>
Org projects are a simple way to combine and link multiple org files together into one complete export. The complete docs are <a href="http://orgmode.org/manual/Publishing.html">here</a>.
</p>

<p>
To create an org project, all you need to do is set <code>org-publish-project-alist</code>. Here's a simple example.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #5e6263;">;; </span><span style="color: #5e6263;">Setup</span>
(<span style="color: #598249;">setq</span> org-publish-project-alist
      `((<span style="color: #15968D;">"project-name"</span>
         <span style="color: #598249;">:base-directory</span> <span style="color: #15968D;">"~/org-project"</span>
         <span style="color: #598249;">:recursive</span> t
         <span style="color: #598249;">:publishing-directory</span> <span style="color: #15968D;">"/var/www/html"</span>
         <span style="color: #598249;">:publishing-function</span> org-html-publish-to-html)))

<span style="color: #5e6263;">;; </span><span style="color: #5e6263;">Publish with</span>
(org-publish-current-project) <span style="color: #5e6263;">;; </span><span style="color: #5e6263;">While having a file in your project open</span>
<span style="color: #5e6263;">;; </span><span style="color: #5e6263;">OR</span>
<span style="color: #5e6263;">;; </span><span style="color: #5e6263;">M-x org-publish &lt;RET&gt; project-name &lt;RET&gt;</span>
</pre>
</div>

<p>
Once this is run, you'll have a new org project with those following parameters, and you can publish the project using <code>org-publish-project</code>.
Just place your org files in <code>~/org-project</code>, and org will export them to HTML (using <code>org-html-publish-to-html</code>) and place them in <code>/var/www/html</code>.
</p>

<p>
Running the export again will cache the output files, if they have not changed, which can be useful. If you want to trigger a full rebuild, you can run <code>(org-publish "project-name" t)</code>.
</p>

<p>
Files that are linked with <code>org-insert-link</code> will link fine in the export, as long as they are <i>realtive links</i>. This should happen automatically, but occasionally, you have to tweak a few links.
</p>
</div>
</div>

<div id="outline-container-org0554083" class="outline-3">
<h3 id="h:ifffi9s0gyh0"><a id="org0554083"></a><span class="section-number-3">2.2</span> Customization</h3>
<div class="outline-text-3" id="text-h:ifffi9s0gyh0">
<p>
While the above setup works, there's a lot we might want to change. For instance, we might want to turn of table of contents for the entire project.
For a single file, we would put <code>#+OPTIONS: toc:nil</code>, but to apply this to every file in our project, we can add <code>:with-toc nil</code> to the project above. <a href="http://orgmode.org/manual/Publishing-options.html#Publishing-options">Here are the rest of the default org project options.</a>
</p>
</div>
</div>

<div id="outline-container-org995b1f5" class="outline-3">
<h3 id="h:edjfi9s0gyh0"><a id="org995b1f5"></a><span class="section-number-3">2.3</span> Making this Shareable</h3>
<div class="outline-text-3" id="text-h:edjfi9s0gyh0">
<p>
Some people might want to put this <code>setq</code> call in your Emacs dotfiles, but I prefer to place it in a <a href="https://github.com/jgkamat/jgkamat.github.io/blob/sources/jgkamat-website.el">seperate emacs lisp file</a> file instead, which lets others get the same project definition. It also lets you put other changes you make in this file as well, since all those changes will be elisp. Anyone who wants to work with your project simply needs to source this file, instead of setting up the project again.
</p>

<p>
In order to make sure others can use this flawlessly, we need to remove these absolute links from our project, such as <code>/var/www/html</code> and <code>~/org-project</code>, since we can't expect everyone to have the same directory structure as we do. Since we are loading the static file <code>jgkamat-website.el</code>, we can define the root/export in terms of this file. This is one way to do that, assuming that <code>jgkamat-website.el</code> is in the root:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #598249;">let</span> ((proj-base (file-name-directory load-file-name)))
  (<span style="color: #598249;">setq</span> org-publish-project-alist
        `((<span style="color: #15968D;">"project-name"</span>
           <span style="color: #598249;">:base-directory</span> ,(concat proj-base <span style="color: #15968D;">"."</span>)
           <span style="color: #598249;">:recursive</span> t
           <span style="color: #598249;">:publishing-directory</span> ,(concat proj-base  <span style="color: #15968D;">"../export"</span>)
           <span style="color: #598249;">:publishing-function</span> org-html-publish-to-html))))
</pre>
</div>

<p>
The org project definition for this blog (in <a href="https://github.com/jgkamat/jgkamat.github.io/blob/sources/jgkamat-website.el">jgkamat-website.el</a> is not much more complicated than this one.
The main difference is it has a bunch of org project customizations turned on, and it's using <code>ox-twbs</code> instead of the native html exporter.
This is done by changing the <code>:publishing-function</code> to <code>org-twbs-publish-to-html</code>, which is in the <code>ox-twbs</code> docs.
</p>
</div>
</div>
</div>

<div id="outline-container-orgd801537" class="outline-2">
<h2 id="h:7bnfi9s0gyh0"><a id="orgd801537"></a><span class="section-number-2">3</span> Custom CSS on HTML Exports</h2>
<div class="outline-text-2" id="text-h:7bnfi9s0gyh0">
<p>
We've got a nice website now, but it looks pretty bare bones. How do we provide our own CSS?
</p>

<p>
The easiest way to apply a CSS file to your org project (with exporters based on the html one) is to add this to your <code>org-publish-project-alist</code> directive:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #598249;">:html-head-extra</span> <span style="color: #15968D;">"&lt;link rel=\"stylesheet\" href=\"./myfile.css\"&gt;"</span>
</pre>
</div>

<p>
Another option is to set <code>#+HTML_HEAD_EXTRA</code> at the top of your org files.
</p>

<p>
I'm very new to 'webdev', so actually creating the CSS was a struggle for me. <a href="https://github.com/jgkamat/jgkamat.github.io/blob/master/src/jgkamat.css">This is the final result.</a>
</p>
</div>
</div>

<div id="outline-container-org00e168b" class="outline-2">
<h2 id="h:qyqfi9s0gyh0"><a id="org00e168b"></a><span class="section-number-2">4</span> Dynamic Org Exports</h2>
<div class="outline-text-2" id="text-h:qyqfi9s0gyh0">
<p>
We've got our nice org project for easy export, custom CSS styling, and maybe even a custom org exporter to get our website looking just how we want it, but how can we get dynamic exports?
In my case, I wanted an <a href="home.html">aggregation of all my (sorted) blog posts</a> and <a href="#h:722gi9s0gyh0">previous/next links on all my blog entries</a>
</p>

<p>
The solution I found to this really showed me the power and flexibility of org mode. Placing this block in org source:
</p>


<div class="org-src-container">
<pre class="src src-org"><span style="color: #5e6263;">#+BEGIN_SRC emacs-lisp :exports results :results raw</span>
(print <span style="color: #15968D;">"hello world! *bold* /slant/ +strikethrough+"</span>)
<span style="color: #5e6263;">#+END_SRC</span>
</pre>
</div>

<p>
Results in this output:
</p>

<p>
hello world! <b>bold</b> <i>slant</i> <del>strikethrough</del>
</p>

<p>
By using the <code>:exports results :results raw</code> directive to source code blocks, we can evaluate them when building our org file, and their result will be inserted into the org document <i>as if we wrote it ourselves</i>!
</p>

<p>
To generate the dynamic content I want, I just created elisp functions for whatever I needed.
After creating a <code>(gen-links)</code> to generate a sorted list of org blog posts, and a <code>(gen-prev-next)</code> to generate previous and next links, all I needed to do was:
</p>

<div class="org-src-container">
<pre class="src src-org"><span style="color: #5e6263;"># For sorted list of posts</span>
<span style="color: #5e6263;">#+BEGIN_SRC emacs-lisp :exports results :results raw</span>
(gen-links)
<span style="color: #5e6263;">#+END_SRC</span>

<span style="color: #5e6263;"># For prev/next links</span>
<span style="color: #5e6263;">#+BEGIN_SRC emacs-lisp :exports results :results raw</span>
(gen-prev-next)
<span style="color: #5e6263;">#+END_SRC</span>
</pre>
</div>

<p>
I put the source for these functions in my <a href="https://github.com/jgkamat/jgkamat.github.io/blob/sources/jgkamat-website.el">jgkamat-website.el</a>. These functions work by parsing all my org files in <code>/blog</code> and sorting them by the <code>#+DATE</code>, and displaying the relevant information.
They need some more work, but they are usable for now. I might post about how I made those functions later&#x2026;
</p>
</div>
</div>

<div id="outline-container-orgc594228" class="outline-2">
<h2 id="h:pmufi9s0gyh0"><a id="orgc594228"></a><span class="section-number-2">5</span> Side Note: Divs</h2>
<div class="outline-text-2" id="text-h:pmufi9s0gyh0">
<p>
It might be nice to generate divs in your html file from your org source. I used this to get my prev/next links into a nice 3 part table. You can insert a div with class <code>classname</code> like this:
</p>

<div class="org-src-container">
<pre class="src src-org"><span style="color: #5e6263;">#+begin_classname</span>
Content inside your div
<span style="color: #5e6263;">#+end_classname</span>
</pre>
</div>

<p>
I created divs called <code>div-wrap</code>, <code>div-left</code>, <code>div-right</code>, and <code>div-center</code> for this purpose, and referenced them in CSS to get them to fit properly. The actual divs are generated in the elisp source code blocks.
</p>
</div>
</div>

<div id="outline-container-org29ac959" class="outline-2">
<h2 id="h:u4yfi9s0gyh0"><a id="org29ac959"></a><span class="section-number-2">6</span> Wrapping Up</h2>
<div class="outline-text-2" id="text-h:u4yfi9s0gyh0">
<p>
Creating an org blog is a lot easier than it seems, if you know how to use org's features to your advantage.
</p>

<p>
Let me know via a <a href="https://github.com/jgkamat/jgkamat.github.io/issues">github issue</a> (or a PR) if you find anything wrong on this post/website/anything, and I'll get on it!
</p>

<p>
Here are some other successful org blogs:
</p>
<ul class="org-ul">
<li><a href="http://endlessparentheses.com/how-i-blog-one-year-of-posts-in-a-single-org-file.html">Endless Parentheses</a> (Jekyll Based)</li>
<li><a href="https://ogbe.net/blog/blogging_with_org.html">Dennis Ogbe</a> (Plain Org)</li>
<li><a href="https://gjhenrique.com/meta.html">gjhenrique</a> (Plain Org)</li>
</ul>

<p>
The source code for all of this is <a href="https://github.com/jgkamat/jgkamat.github.io">at this github repo</a>.
</p>

<p>
Lastly, here's an obligatory screenshot of me editing this post. <code>=)</code>
</p>


<div class="figure">
<p><a href="https://user-images.githubusercontent.com/4349709/27512957-922c8724-5908-11e7-81a6-866dcf54245b.png"><img src="https://user-images.githubusercontent.com/4349709/27512957-922c8724-5908-11e7-81a6-866dcf54245b.png" alt="27512957-922c8724-5908-11e7-81a6-866dcf54245b.png" /></a>
</p>
</div>
</div>
</div>

<div id="outline-container-orgb941bad" class="outline-2">
<h2 id="h:722gi9s0gyh0"><a id="orgb941bad"></a><span class="section-number-2">7</span> Navigation</h2>
<div class="outline-text-2" id="text-h:722gi9s0gyh0">
<div class="div-wrap">
<div class="div-left">
<p>
<a href="home.html">&larr; Blog Home</a>
</p>

</div>
<div class="div-center">
<p>
<a href="home.html">⟨Blog Home⟩</a>
</p>

</div>
<div class="div-right">
<p>
<a href="applications.html">Productivity and Applications &rarr;</a>
</p>

</div>

</div>
</div>
</div>
</div>
<div id="postamble" class="status">

<div>
<p class="author">Author: <a href="https://github.com/jgkamat/jgkamat.github.io">Jay Kamat</a></p>
<p class="date">Published: 2016-12-06</p>
<p class="creator"><a href="https://www.gnu.org/software/emacs/">Emacs</a> 25.3.1 (<a href="https://orgmode.org">Org</a> mode 9.1.12)</p>
</div>
</div>
</body>
</html>
